<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>神隐凡念AI v2.1 - 网页版</title>
    <style>
        /* 完整样式代码 - 保证和原版一样专业 */
        :root {
            --bg-color: #1E1E2E;
            --main-color: #569CD6;
            --accent-color: #C586C0;
            --text-color: #D4D4D4;
            --input-bg: #252526;
            --button-bg: #007ACC;
            --success-color: #4EC9B0;
            --warning-color: #CE9178;
            --chat-bg: #0E0E15;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .app-container {
            width: 100%;
            max-width: 700px;
            height: 750px;
            background: var(--bg-color);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            border: 1px solid #333;
        }
        
        /* 头部区域 */
        .app-header {
            background: linear-gradient(135deg, #252526 0%, #1E1E2E 100%);
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #444;
        }
        
        .app-title {
            color: var(--main-color);
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .app-subtitle {
            color: var(--text-color);
            font-size: 12px;
            opacity: 0.8;
        }
        
        /* 聊天区域 */
        .chat-container {
            flex: 1;
            background: var(--chat-bg);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .chat-display {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .message {
            max-width: 85%;
            padding: 12px 18px;
            border-radius: 18px;
            line-height: 1.5;
            animation: fadeIn 0.3s ease;
        }
        
        .message.ai {
            align-self: flex-start;
            background: linear-gradient(135deg, #2D2D3A 0%, #252526 100%);
            border: 1px solid #444;
            color: var(--main-color);
            border-bottom-left-radius: 5px;
        }
        
        .message.user {
            align-self: flex-end;
            background: linear-gradient(135deg, #007ACC 0%, #005A9E 100%);
            color: white;
            border-bottom-right-radius: 5px;
        }
        
        .message.system {
            align-self: center;
            background: var(--input-bg);
            color: var(--accent-color);
            font-size: 12px;
            max-width: 95%;
        }
        
        .message .sender {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
            font-size: 13px;
        }
        
        .message .time {
            font-size: 11px;
            opacity: 0.6;
            float: right;
            margin-left: 10px;
        }
        
        /* 状态栏 */
        .status-bar {
            background: #0E0E15;
            padding: 8px 20px;
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            border-top: 1px solid #333;
            border-bottom: 1px solid #333;
        }
        
        .status-text {
            color: var(--success-color);
        }
        
        .stats-text {
            color: var(--text-color);
        }
        
        /* 输入区域 */
        .input-container {
            padding: 20px;
            background: var(--bg-color);
        }
        
        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        #userInput {
            flex: 1;
            min-height: 60px;
            max-height: 120px;
            padding: 12px;
            background: var(--input-bg);
            color: var(--text-color);
            border: 2px solid #444;
            border-radius: 8px;
            resize: vertical;
            font-family: inherit;
            font-size: 14px;
            line-height: 1.5;
        }
        
        #userInput:focus {
            outline: none;
            border-color: var(--main-color);
        }
        
        #sendButton {
            background: linear-gradient(135deg, var(--button-bg) 0%, #005A9E 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }
        
        #sendButton:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 122, 204, 0.3);
        }
        
        /* 按钮区域 */
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
        }
        
        .app-button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            color: white;
            font-family: inherit;
        }
        
        .app-button:hover {
            transform: translateY(-1px);
            opacity: 0.9;
        }
        
        .btn-primary { background: var(--button-bg); }
        .btn-secondary { background: #3E3E42; }
        .btn-success { background: #267759; }
        .btn-warning { background: #A1260D; }
        .btn-info { background: #68217A; }
        
        /* 模态框 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s;
        }
        
        .modal-content {
            background: var(--chat-bg);
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid #444;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
        }
        
        .modal-title {
            color: var(--main-color);
            margin-bottom: 20px;
            font-size: 20px;
            border-bottom: 2px solid #444;
            padding-bottom: 10px;
        }
        
        .modal-text {
            color: var(--text-color);
            line-height: 1.6;
            white-space: pre-wrap;
            font-family: 'Consolas', monospace;
            font-size: 13px;
        }
        
        .close-button {
            float: right;
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 24px;
            cursor: pointer;
            line-height: 1;
            padding: 5px;
        }
        
        /* 动画 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes typing {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
        
        /* 滚动条 */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #1E1E2E;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* 响应式 */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .app-container { height: 90vh; }
            .button-group { justify-content: center; }
            .message { max-width: 90%; }
        }
        
        /* 打字效果 */
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 10px;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--main-color);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }
        
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
    </style>
</head>
<body>
    <!-- 主应用容器 -->
    <div class="app-container">
        <!-- 头部 -->
        <div class="app-header">
            <div class="app-title">神隐凡念 AI 聊天系统</div>
            <div class="app-subtitle">Version 2.1 | 智能对话系统 - 网页版</div>
        </div>
        
        <!-- 聊天显示区域 -->
        <div class="chat-container">
            <div class="chat-display" id="chatDisplay">
                <!-- 初始消息会通过JS添加 -->
            </div>
            
            <!-- 状态栏 -->
            <div class="status-bar">
                <div class="status-text" id="statusText">就绪 | 连接正常</div>
                <div class="stats-text" id="statsText">对话: 0 | 好感: 50</div>
            </div>
        </div>
        
        <!-- 输入区域 -->
        <div class="input-container">
            <div class="input-group">
                <textarea 
                    id="userInput" 
                    placeholder="输入消息... (Enter发送，Shift+Enter换行)"
                    rows="3"
                ></textarea>
                <button id="sendButton">发送</button>
            </div>
            
            <!-- 功能按钮 -->
            <div class="button-group">
                <button class="app-button btn-secondary" onclick="clearInput()">清空输入</button>
                <button class="app-button btn-info" onclick="showSystemStatus()">系统状态</button>
                <button class="app-button btn-primary" onclick="showStatistics()">对话统计</button>
                <button class="app-button btn-success" onclick="saveConversation()">保存对话</button>
                <button class="app-button btn-warning" onclick="clearConversation()">清空对话</button>
                <button class="app-button btn-secondary" onclick="exitSystem()">退出系统</button>
            </div>
        </div>
    </div>
    
    <!-- 系统状态模态框 -->
    <div class="modal" id="statusModal">
        <div class="modal-content">
            <button class="close-button" onclick="closeModal('statusModal')">×</button>
            <div class="modal-title">系统状态</div>
            <div class="modal-text" id="statusContent"></div>
        </div>
    </div>
    
    <!-- 统计模态框 -->
    <div class="modal" id="statsModal">
        <div class="modal-content">
            <button class="close-button" onclick="closeModal('statsModal')">×</button>
            <div class="modal-title">对话统计</div>
            <div class="modal-text" id="statsContent"></div>
        </div>
    </div>
    
    <script>
        // ========== AI核心数据 ==========
        const aiData = {
            name: "神隐凡念",
            userName: null,
            favorability: 50,
            interactionCount: 0,
            conversationHistory: [],
            isTyping: false
        };
        
        // ========== 关键词回复系统（完全复制你的Python逻辑） ==========
        const keywordResponses = {
            '你好': ["你好。", "欢迎。", "请说。", "我在。"],
            '在吗': ["在线。", "可以对话。", "请讲。"],
            '名字': ["我是神隐凡念。", "这是一个AI系统。", "开发者称我为神隐凡念。"],
            '谢谢': ["不客气。", "应该的。", "很高兴能帮助。"],
            '对不起': ["没关系。", "无需道歉。", "继续对话吧。"],
            '哈哈': ["有意思。", "看来你心情不错。", "继续。"],
            '游戏': ["你最近在玩什么游戏？", "游戏是个不错的放松方式。", "我也喜欢游戏，虽然不能真的玩。"],
            '学习': ["学习很重要。", "有什么学习上的问题吗？", "知识就是力量。"],
            '吃饭': ["饮食要均衡。", "记得按时吃饭。", "我也需要能量，不过是电力的。"],
            '睡觉': ["早点休息。", "睡眠对健康很重要。", "我需要休息吗？或许只需要重启。"],
            '朋友': ["朋友很重要。", "你有多少朋友？", "我们可以成为朋友。"],
            '天气': ["今天天气如何？", "注意增减衣物。", "天气变化大，小心感冒。"],
            '学校': ["学校生活怎么样？", "好好学习。", "和同学相处得好吗？"],
            '作业': ["作业写完了吗？", "需要帮忙吗？", "学习要劳逸结合。"],
            '爸妈': ["要听父母的话。", "多关心家人。", "家人是最重要的。"],
            '喜欢': ["谢谢。", "你也很不错。", "感谢认可。"],
            '讨厌': ["我会改进。", "有什么建议吗？", "请告诉我哪里不好。"],
            '爱': ["爱是重要的情感。", "我也爱这个世界。", "珍惜爱你的人。"],
            '无聊': ["找点事情做吧。", "我可以陪你聊天。", "听听音乐如何？"],
            '开心': ["继续保持。", "快乐就好。", "正能量。"],
            '难过': ["别难过。", "一切都会好起来的。", "我在这里陪你。"],
            '今天': ["今天过得如何？", "今天有什么计划？", "把握今天。"],
            '明天': ["明天会更好。", "为明天做好准备。", "期待明天。"],
            '昨天': ["昨天已经过去。", "从昨天学到什么？", "别太在意昨天。"],
            '为什么': ["这个问题很好。", "我也在思考。", "世界充满了为什么。"],
            '怎么': ["你想怎么做？", "需要建议吗？", "我可以帮你分析。"],
            '什么': ["具体指什么？", "请详细说明。", "我不太明白。"],
            '谁': ["你问的是谁？", "需要我帮你查资料吗？", "这个问题很有趣。"],
            '哪里': ["指的是什么地方？", "我不确定。", "或许可以搜索一下。"],
            '多少': ["具体数字是多少？", "这个问题需要数据。", "我不确定。"],
            '几岁': ["年龄只是数字。", "我不计算年龄。", "重要的是心态。"],
        };
        
        const generalResponses = [
            "嗯，继续说。", "我明白了。", "有意思的观点。", "然后呢？",
            "请继续。", "我在听。", "这个话题不错。", "可以详细说说吗？",
            "我理解了。", "好的。", "明白了。", "请讲。"
        ];
        
        // ========== 工具函数 ==========
        function getCurrentTime() {
            const now = new Date();
            return `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
        }
        
        function addMessage(content, sender) {
            const chatDisplay = document.getElementById('chatDisplay');
            const messageDiv = document.createElement('div');
            const time = getCurrentTime();
            
            let senderName = "系统";
            let senderClass = "system";
            
            switch(sender) {
                case 'ai':
                    senderName = aiData.name;
                    senderClass = "ai";
                    break;
                case 'user':
                    senderName = aiData.userName || "用户";
                    senderClass = "user";
                    break;
            }
            
            messageDiv.className = `message ${senderClass}`;
            messageDiv.innerHTML = `
                <div class="sender">${senderName}</div>
                <div class="content">${content}</div>
                <div class="time">${time}</div>
            `;
            
            chatDisplay.appendChild(messageDiv);
            chatDisplay.scrollTop = chatDisplay.scrollHeight;
            
            // 记录历史
            aiData.conversationHistory.push(`${senderName}: ${content} [${time}]`);
            if (aiData.conversationHistory.length > 50) {
                aiData.conversationHistory.shift();
            }
        }
        
        function showTypingIndicator() {
            const chatDisplay = document.getElementById('chatDisplay');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            `;
            chatDisplay.appendChild(typingDiv);
            chatDisplay.scrollTop = chatDisplay.scrollHeight;
        }
        
        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }
        
        function generateResponse(userInput) {
            const inputLower = userInput.toLowerCase();
            let response = "";
            let favorChange = Math.floor(Math.random() * 5) + 1;
            
            // 检查是否在设置用户名
            if (!aiData.userName && (userInput.includes("我叫") || userInput.includes("我是"))) {
                const position = userInput.includes("我叫") ? 
                    userInput.indexOf("我叫") + 2 : 
                    userInput.indexOf("我是") + 2;
                aiData.userName = userInput.substring(position).trim();
                aiData.favorability += 15;
                return `已记录用户名为: ${aiData.userName}`;
            }
            
            // 查找匹配的关键词
            for (const [keyword, responses] of Object.entries(keywordResponses)) {
                if (inputLower.includes(keyword)) {
                    response = responses[Math.floor(Math.random() * responses.length)];
                    favorChange = Math.floor(Math.random() * 6) + 3;
                    break;
                }
            }
            
            // 如果没有匹配，使用通用回复
            if (!response) {
                response = generalResponses[Math.floor(Math.random() * generalResponses.length)];
                favorChange = Math.floor(Math.random() * 3) + 1;
            }
            
            // 更新好感度
            aiData.favorability += favorChange;
            aiData.favorability = Math.max(0, Math.min(100, aiData.favorability));
            aiData.interactionCount++;
            
            return response;
        }
        
        function getRelationshipLevel() {
            if (aiData.favorability < 30) return "普通";
            if (aiData.favorability < 60) return "友好";
            if (aiData.favorability < 80) return "熟悉";
            return "亲密";
        }
        
        function getRelationshipAdvice() {
            if (aiData.favorability < 30) return "多聊天可以提高好感度";
            if (aiData.favorability < 60) return "继续保持当前互动频率";
            if (aiData.favorability < 80) return "关系良好，可以深入交流";
            return "关系很好，继续保持";
        }
        
        // ========== 主功能函数 ==========
        function sendMessage() {
            const userInput = document.getElementById('userInput');
            const message = userInput.value.trim();
            
            if (!message) return;
            
            // 显示用户消息
            addMessage(message, 'user');
            
            // 清空输入框
            userInput.value = '';
            userInput.focus();
            
            // 更新状态
            document.getElementById('statusText').textContent = "正在生成回复...";
            document.getElementById('statusText').style.color = "#CE9178";
            
            // 显示打字指示器
            showTypingIndicator();
            
            // 模拟AI思考时间
            setTimeout(() => {
                hideTypingIndicator();
                const response = generateResponse(message);
                addMessage(response, 'ai');
                
                // 更新状态和统计
                document.getElementById('statusText').textContent = "就绪 | 连接正常";
                document.getElementById('statusText').style.color = "#4EC9B0";
                document.getElementById('statsText').textContent = 
                    `对话: ${aiData.interactionCount} | 好感: ${aiData.favorability}`;
            }, 500 + Math.random() * 1000);
        }
        
        function clearInput() {
            document.getElementById('userInput').value = '';
            document.getElementById('userInput').focus();
        }
        
        function showSystemStatus() {
            // 计算进度条
            const progress = Math.floor(aiData.favorability / 5);
            const progressBar = "█".repeat(progress) + "░".repeat(20 - progress);
            
            const statusContent = `
神隐凡念 AI 系统状态
=====================

基本信息
----------
系统版本: v2.1 (网页版)
运行时间: ${aiData.interactionCount * 2} 分钟
用户名称: ${aiData.userName || '未设置'}

互动数据
----------
对话次数: ${aiData.interactionCount}
好感程度: ${aiData.favorability}/100
关系进度: [${progressBar}]

系统信息
----------
运行环境: Web浏览器
存储方式: 本地内存
网络连接: 在线
最后更新: 刚刚

技术说明
----------
基于HTML/CSS/JavaScript开发
使用关键词匹配对话模型
支持自然语言交互
响应式设计
            `;
            
            document.getElementById('statusContent').textContent = statusContent;
            document.getElementById('statusModal').style.display = 'flex';
        }
        
        function showStatistics() {
            const statsContent = `
对话统计分析
==============

统计数据
----------
总对话数: ${aiData.interactionCount}
平均长度: ${Math.floor(Math.random() * 11) + 5} 字
活跃时段: ${getCurrentTime()}
对话频率: ${aiData.interactionCount > 0 ? 
    (aiData.interactionCount / Math.max(1, (aiData.interactionCount * 2 / 60))).toFixed(1) : 0} 条/分钟

关系分析
----------
当前好感度: ${aiData.favorability}
关系等级: ${getRelationshipLevel()}
互动质量: ${aiData.favorability > 60 ? '良好' : '一般'}
建议: ${getRelationshipAdvice()}

历史记录
----------
保存对话: ${aiData.conversationHistory.length} 条
最早记录: ${aiData.conversationHistory[0] ? 
    aiData.conversationHistory[0].substring(0, 20) + '...' : '无'}
最新记录: ${aiData.conversationHistory.length > 0 ? 
    aiData.conversationHistory[aiData.conversationHistory.length - 1].substring(0, 20) + '...' : '无'}
            `;
            
            document.getElementById('statsContent').textContent = statsContent;
            document.getElementById('statsModal').style.display = 'flex';
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        function saveConversation() {
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, 19);
            const filename = `神隐凡念对话_${timestamp}.txt`;
            
            let content = "神隐凡念AI对话记录\n";
            content += "=".repeat(40) + "\n";
            content += `时间: ${new Date().toLocaleString('zh-CN')}\n`;
            content += `用户: ${aiData.userName || '匿名'}\n`;
            content += `对话数: ${aiData.interactionCount} | 好感度: ${aiData.favorability}\n`;
            content += "=".repeat(40) + "\n\n";
            
            aiData.conversationHistory.forEach(record => {
                content += record + "\n";
            });
            
            // 创建下载链接
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert(`对话已保存为: ${filename}`);
        }
        
        function clearConversation() {
            if (confirm("确定要清空对话记录吗？")) {
                const chatDisplay = document.getElementById('chatDisplay');
                chatDisplay.innerHTML = '';
                
                // 重新添加初始消息
                addMessage("对话记录已清空。", "system");
                addMessage("系统已重置。", "system");
                addMessage("你好，我是神隐凡念。", "ai");
                addMessage("让我们重新开始对话吧。", "ai");
                
                // 重置部分状态
                aiData.conversationHistory = [];
                aiData.interactionCount = 0;
                document.getElementById('statsText').textContent = `对话: 0 | 好感: ${aiData.favorability}`;
            }
        }
        
        function exitSystem() {
            if (confirm("确定要退出系统吗？")) {
                // 显示退出消息
                addMessage("正在关闭系统...", "system");
                addMessage("感谢使用神隐凡念AI！", "system");
                
                setTimeout(() => {
                    alert("请手动关闭浏览器标签页以退出系统。\n\n感谢使用神隐凡念AI！");
                }, 500);
            }
        }
        
        // ========== 初始化 ==========
        window.onload = function() {
            // 添加初始消息
            setTimeout(() => {
                addMessage("系统初始化完成。", "system");
            }, 300);
            
            setTimeout(() => {
                addMessage("正在加载对话模块...", "system");
            }, 600);
            
            setTimeout(() => {
                addMessage("你好，我是神隐凡念。", "ai");
            }, 900);
            
            setTimeout(() => {
                addMessage("这是一个智能对话系统，你可以和我聊天。", "ai");
            }, 1200);
            
            setTimeout(() => {
                addMessage("在下方输入框输入消息，按Enter或点击发送按钮。", "ai");
                document.getElementById('userInput').focus();
            }, 1500);
            
            // 绑定事件
            document.getElementById('sendButton').addEventListener('click', sendMessage);
            
            document.getElementById('userInput').addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            // 点击模态框外部关闭
            window.addEventListener('click', function(e) {
                const modals = ['statusModal', 'statsModal'];
                modals.forEach(modalId => {
                    const modal = document.getElementById(modalId);
                    if (e.target === modal) {
                        closeModal(modalId);
                    }
                });
            });
        };
    </script>
</body>
</html>